# Deployment Guide

## Prerequisites
- Node.js 18+ installed
- MongoDB Atlas account (for production database)
- Vercel account (recommended) or another hosting platform

## Environment Variables

Create a `.env.local` file (already created) or set these in your hosting platform:

```
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/pushup-checker?retryWrites=true&w=majority
NEXT_PUBLIC_APP_URL=https://your-domain.com
```

## Deploy to Vercel (Recommended)

1. **Install Vercel CLI** (if not already installed):
   ```bash
   npm i -g vercel
   ```

2. **Login to Vercel**:
   ```bash
   vercel login
   ```

3. **Deploy**:
   ```bash
   vercel
   ```

4. **Set Environment Variables** in Vercel Dashboard:
   - Go to your project settings
   - Navigate to Environment Variables
   - Add `MONGODB_URI` and `NEXT_PUBLIC_APP_URL`

5. **Redeploy** after adding environment variables:
   ```bash
   vercel --prod
   ```

## Deploy to Other Platforms

### Netlify
1. Connect your Git repository
2. Set build command: `npm run build`
3. Set publish directory: `.next`
4. Add environment variables in Netlify dashboard

### Railway
1. Connect your Git repository
2. Railway will auto-detect Next.js
3. Add environment variables in Railway dashboard
4. Deploy automatically on push

### Self-Hosted
1. Build the application:
   ```bash
   npm run build
   ```

2. Start the production server:
   ```bash
   npm start
   ```

3. The app will run on `http://localhost:3000`

## Post-Deployment Checklist

- [ ] Verify MongoDB connection is working
- [ ] Test camera permissions (requires HTTPS)
- [ ] Test pose detection functionality
- [ ] Verify audio playback works
- [ ] Check all routes are accessible
- [ ] Test on mobile devices
- [ ] Verify environment variables are set correctly

## Important Notes

1. **HTTPS Required**: Camera access requires HTTPS in production. Vercel provides this automatically.

2. **MongoDB**: Make sure your MongoDB Atlas cluster allows connections from your deployment IP (0.0.0.0/0 for Vercel).

3. **MediaPipe Models**: The app loads MediaPipe models from CDN. Ensure your deployment has internet access.

4. **Bundle Size**: The app uses dynamic imports to keep bundle size under 500KB. Monitor bundle size in production.

## Troubleshooting

- **Build Fails**: Check TypeScript errors with `npm run type-check`
- **Camera Not Working**: Ensure HTTPS is enabled and browser permissions are granted
- **Database Connection Issues**: Verify MongoDB URI and network access
- **Pose Detection Not Loading**: Check browser console for CDN loading errors

### Browser Console Warnings

#### "Unchecked runtime.lastError: The message port closed before a response was received"

**Status**: âœ… **Safe to Ignore** - This is NOT caused by your app code.

**Explanation**: This error is generated by browser extensions (ad blockers, password managers, privacy extensions, etc.) trying to communicate with content scripts. It occurs when:
- An extension's background script tries to send a message to a content script
- The page navigates or reloads before the message is received
- The extension's context becomes invalidated

**Why it's safe to ignore**:
- It doesn't affect your app's functionality
- It's not generated by your React/Next.js code
- It's a common warning in modern web apps
- Your app already suppresses these errors in production

**What we do**:
- The app automatically suppresses these errors in `src/app/layout.tsx`
- Both `window.error` events and `console.error` calls are filtered
- Real errors from your app code are still logged normally

**For end users**: This warning is harmless and can be safely ignored. It's a browser extension issue, not an app issue.

**If you want to debug**:
1. Open the app in an incognito/private window (extensions are usually disabled)
2. The error should disappear, confirming it's from extensions
3. Disable browser extensions one by one to identify the culprit (optional)

#### Other Common Browser Warnings

- **MediaStream errors**: Usually related to camera permissions or browser security policies
- **CORS errors**: Check API endpoint configuration and CORS headers
- **Network errors**: Verify API endpoints are accessible and environment variables are set

